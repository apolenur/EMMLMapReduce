<mashup name="TreasuryHAMPModCountByMSA" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openmashup.org/schemas/v1.0/EMML ../schemas/EMMLPrestoSpec.xsd" xmlns="http://www.openmashup.org/schemas/v1.0/EMML" xmlns:macro="http://www.openmashup.org/schemas/v1.0/EMMLMacro" xmlns:presto="http://www.jackbe.com/v1.0/EMMLPrestoExtensions" >
<operation name="runMashup" >

<namespaces></namespaces>
<variable name="limitRecords" type="number" default="-2"/>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"inputparam_2":{"label":"inputparam_2"},"StringBuilder_3":{"label":"String Builder","ipStr":[["select count(1) from TreasuryHAMP where prop_geoc_cnsus_msa_cd = ",0.4115435474086553],["{$inputparam_2}",0.385076102335006]]},"SQL_1":{"label":"SQL","datasourceName":"BigData","sqlCommand":"{$StringBuilder_3_out}","startRow":1,"rowCount":20,"fetchSize":20,"datasourceDetails":[{"maxIdle":null,"validationCallTimeout":null,"state":"AVAILABLE","validationQuery":"","jdbcDriverName":"HSQL","password":"presto","maxActive":null,"poolPreparedStatements":false,"numTestsPerEvictionRun":null,"userId":"presto","name":"BigData","maxWait":null,"minIdle":null,"minEvictableIdleTimeMillis":null,"timeBetweenEvictionRunsMillis":null,"jdbcUrl":"jdbc:mysql://presto270db.coksdj9a4svg.us-east-1.rds.amazonaws.com/BigData","initialSize":null},{"maxIdle":null,"validationCallTimeout":null,"state":"AVAILABLE","validationQuery":null,"jdbcDriverName":"HSQL","password":"presto","maxActive":null,"poolPreparedStatements":null,"numTestsPerEvictionRun":null,"userId":"presto","name":"PrestoRepositoryDataSource","maxWait":null,"minIdle":null,"minEvictableIdleTimeMillis":null,"timeBetweenEvictionRunsMillis":null,"jdbcUrl":"jdbc:mysql://presto270db.coksdj9a4svg.us-east-1.rds.amazonaws.com/presto_hadoop","initialSize":null},{"maxIdle":null,"validationCallTimeout":null,"state":"AVAILABLE","validationQuery":null,"jdbcDriverName":"HSQL","password":"presto","maxActive":null,"poolPreparedStatements":null,"numTestsPerEvictionRun":null,"userId":"presto","name":"SnapshotDataSource","maxWait":null,"minIdle":null,"minEvictableIdleTimeMillis":null,"timeBetweenEvictionRunsMillis":null,"jdbcUrl":"jdbc:mysql://presto270db.coksdj9a4svg.us-east-1.rds.amazonaws.com/presto_hadoop","initialSize":null}],"driverclass":"com.mysql.jdbc.Driver","useAtt":true,"stmtType":{"query":true,"update":false}},"Document_7":{"label":"Document","doc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"MSA_Code","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"{$inputparam_2}"},"arrayParent":null},{"name":"Mod_Count","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$SQL_1_out/*:records/*:record/*:column1"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"TEMPLATE","TEMPLATE":null},"parent":null,"arrayParent":null}}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >8</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="770" y="120" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="SQL_1" style="SQL" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="400" y="120" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_3" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="SQL_1" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_4" value="" style="port;image=images/wires/outport.png;" parent="SQL_1" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="inputparam_2" style="inputparam" parent="1" vertex="true" connectable="0" label="" name="Input" description="Input parameter"><mxGeometry x="60" y="120" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="outport_5" value="" style="port;image=images/wires/outport.png;" parent="inputparam_2" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="StringBuilder_3" style="StringBuilder" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="230" y="120" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_6" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="StringBuilder_3" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_7" value="" style="port;image=images/wires/outport.png;" parent="StringBuilder_3" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="8" value="" parent="1" source="outport_5" target="inport_6" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="9" value="" parent="1" source="outport_7" target="inport_3" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="11" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="12" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="Document_7" style="Document" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="590" y="120" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_13" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="Document_7" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_14" value="" style="port;image=images/wires/outport.png;" parent="Document_7" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="15" value="" parent="1" source="outport_4" target="inport_13" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="16" value="" parent="1" source="outport_14" target="inport_2" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>

<output output-encoding="UTF-8"  wires_id="output_0" name="output_0" type="document" service=""/>
<variable name="StringBuilder_3_out" type="string" default="" />
<input wires_id="inputparam_2" label="inputparam_2" name="inputparam_2" type="string" default='16980'/>  
<assign wires_id="StringBuilder_3" wires_type="StringBuilder" fromexpr="concat('select count(1) from TreasuryHAMP where prop_geoc_cnsus_msa_cd = ',$inputparam_2)" outputvariable="StringBuilder_3_out"/>

<variable name="SQL_1_out" type="document" default="" />


<sequence wires_id="SQL_1" wires_type="SQL">
<sql name="BigData" query="{$StringBuilder_3_out}" outputvariable="SQL_1_out_sql" startRow="1" rowCount="20" fetchSize="20"/>
<assign fromvariable="SQL_1_out_sql" outputvariable="SQL_1_out" wires_id="SQL_1" name="SQL_1"/>
</sequence>
<sequence  name="Document_7" wires_id="Document_7" outputvariable="output_0" wires_type="Document" inputvariable="SQL_1_out" ><constructor outputvariable="ctro1">
<Root>
<MSA_Code>{$inputparam_2}</MSA_Code>
<Mod_Count>{$SQL_1_out/*:records/*:record/*:column1/string()}</Mod_Count>
</Root>
</constructor>
<assign fromvariable="ctro1" outputvariable = "output_0"/></sequence>


</operation>
</mashup>