<mashup name="StockQuoteMapper" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openmashup.org/schemas/v1.0/EMML ../schemas/EMMLPrestoSpec.xsd" xmlns="http://www.openmashup.org/schemas/v1.0/EMML" xmlns:macro="http://www.openmashup.org/schemas/v1.0/EMMLMacro" xmlns:presto="http://www.jackbe.com/v1.0/EMMLPrestoExtensions" >
<operation name="runMashup" >

<namespaces></namespaces>
<variable name="limitRecords" type="number" default="-2"/>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"macro_12":{"label":"StockQuoteExampleMacro","__domain":"JEMSGlobalMacros"},"DataDecorator_13":{"label":"Data Decorator","decorations":{"/*:quote/*:datetime":{"fnsMap":[{"fnType":"string","fnName":"substringBefore","argValues":{"String Fragment of":{"value":"/*:quote/*:datetime","type":"PATH","emmlPath":"$macro_12_out_dec//*:quote/*:datetime"},"Before String":{"value":" ","type":"LITERAL","emmlPath":" "}},"selectedFn":9,"applyOrder":1,"occuranceNum":1}],"selectedFns":[9],"path":"/*:quote/*:datetime"}}},"Transformer_18":{"label":"Transformer","transformDoc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"symbol","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":[],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","COPY":"$DataDecorator_13_out/*:quote/*:symbol"},"isComplex":true,"arrayParent":null},{"name":"price","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","COPY":"$DataDecorator_13_out/*:quote/*:price"},"arrayParent":null},{"name":"date","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","COPY":"$DataDecorator_13_out/*:quote/*:datetime"},"arrayParent":null},{"name":"time","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":[],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","COPY":"$DataDecorator_13_out/*:quote/*:datetime"},"isComplex":true,"arrayParent":null},{"name":"MapReduce","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","COPY":"/quote/MapReduceKey"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"COPY","COPY":null},"parent":null,"arrayParent":null},"@wires_execution_condition":{"expression":"","conditions":[{"lhs":"","rhs":"","operator":{"operator":"matches","opId":"matches","label":"Matches","applyTo":["string","unknown"]},"caseSensitive":false}],"cnjnct":" or "}},"Mapper_11":{"label":"Mapper","transformDoc":{"name":"quote","aName":"stoc:quote","records":[],"namespaces":{"stoc":"http://com.jackbe.com/emmlMapreduce/StockQuoteExample"},"root":null,"tagName":"stoc:quote","path":"/*:quote","pathWithActualNS":"/stoc:quote","pathWithoutNS":"/quote","type":"Complex","childElements":[{"name":"symbol","ns":"stoc","aName":"stoc:symbol","root":null,"parent":null,"tagName":"stoc:symbol","path":"/*:quote/*:symbol","pathWithActualNS":"/stoc:quote/stoc:symbol","pathWithoutNS":"/quote/symbol","type":"unknown","childElements":[],"minOccurs":1,"maxOccurs":1,"values":[],"flag":2,"map":{"type":"COPY","COPY":"/Root/symbol"},"arrayParent":null},{"name":"price","ns":"stoc","aName":"stoc:price","root":null,"parent":null,"tagName":"stoc:price","path":"/*:quote/*:price","pathWithActualNS":"/stoc:quote/stoc:price","pathWithoutNS":"/quote/price","type":"unknown","childElements":[],"minOccurs":1,"maxOccurs":1,"values":[],"flag":2,"map":{"type":"COPY","COPY":"/Root/price"},"arrayParent":null},{"name":"date","ns":"stoc","aName":"stoc:date","root":null,"parent":null,"tagName":"stoc:date","path":"/*:quote/*:date","pathWithActualNS":"/stoc:quote/stoc:date","pathWithoutNS":"/quote/date","type":"unknown","childElements":[],"minOccurs":1,"maxOccurs":1,"values":[],"flag":2,"map":{"type":"COPY","COPY":"/Root/date"},"arrayParent":null},{"name":"time","ns":"stoc","aName":"stoc:time","root":null,"parent":null,"tagName":"stoc:time","path":"/*:quote/*:time","pathWithActualNS":"/stoc:quote/stoc:time","pathWithoutNS":"/quote/time","type":"unknown","childElements":[],"minOccurs":1,"maxOccurs":1,"values":[],"flag":2,"map":{"type":"COPY","COPY":"/Root/time"},"arrayParent":null},{"name":"MapReduceKey","ns":"stoc","aName":"stoc:MapReduceKey","root":null,"parent":null,"tagName":"stoc:MapReduceKey","path":"/*:quote/*:MapReduceKey","pathWithActualNS":"/stoc:quote/stoc:MapReduceKey","pathWithoutNS":"/quote/MapReduceKey","type":"unknown","childElements":[],"minOccurs":1,"maxOccurs":1,"values":[],"flag":2,"map":{"type":"COPY","COPY":"{$StringBuilder_21_out}","TEMPLATE":null},"arrayParent":null}],"minOccurs":0,"maxOccurs":1,"values":[],"isComplex":true,"ns":"stoc","parent":null,"arrayParent":null}},"StringBuilder_21":{"label":"String Builder","ipStr":[["$Transformer_18_out/*:Root/*:symbol",0.6816417989321053],["$Transformer_18_out/*:Root/*:date",0.8832250472623855]]},"NamespaceStripper_38":{"label":"Namespace Stripper"}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >40</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="830" y="60" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="Mapper_11" style="Mapper" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="510" y="60" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_34" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="Mapper_11" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_35" value="" style="port;image=images/wires/outport.png;" parent="Mapper_11" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="macro_12" style="macroTemplate" parent="1" vertex="true" connectable="0" label="" name="Macro" description="Macro"><mxGeometry x="80" y="60" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_38" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="macro_12" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_39" value="" style="port;image=images/wires/outport.png;" parent="macro_12" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="DataDecorator_13" style="DataDecorator" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="220" y="60" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_41" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="DataDecorator_13" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_42" value="" style="port;image=images/wires/outport.png;" parent="DataDecorator_13" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="44" value="" parent="1" source="outport_39" target="inport_41" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="Transformer_18" style="Transformer" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="370" y="60" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_50" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="Transformer_18" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_51" value="" style="port;image=images/wires/outport.png;" parent="Transformer_18" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="StringBuilder_21" style="StringBuilder" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="430" y="180" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_64" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="StringBuilder_21" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_65" value="" style="port;image=images/wires/outport.png;" parent="StringBuilder_21" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="68" value="" parent="1" source="outport_51" target="inport_64" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="69" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="70" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="74" value="" parent="1" source="outport_51" target="inport_34" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="77" value="" parent="1" source="outport_65" target="inport_34" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="NamespaceStripper_38" style="NamespaceStripper" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="680" y="60" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_108" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="NamespaceStripper_38" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_109" value="" style="port;image=images/wires/outport.png;" parent="NamespaceStripper_38" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="111" value="" parent="1" source="outport_109" target="inport_2" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="112" value="" edge="1" parent="1" source="outport_42" target="inport_50"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="113" value="" edge="1" parent="1" source="outport_35" target="inport_108"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>

<output output-encoding="UTF-8"  wires_id="output_0" name="output_0" type="document" service=""/>
<variable name="macro_12_out" type="document" default="" />

<macro:StockQuoteExampleMacro  name="macro_12" outputvariable="macro_12_out" wires_id="macro_12" label="StockQuoteExampleMacro" emmlType="macro:StockQuoteExampleMacro" value="7/8/11 9:52:53 AM,GOOG,475.17"  ></macro:StockQuoteExampleMacro>
<variable name="DataDecorator_13_out" type="document" default="" />

<sequence wires_id='DataDecorator_13' wires_type='DataDecorator'>
<filter filterexpr='$macro_12_out' inputvariable='macro_12_out' outputvariable='macro_12_out_dec' />
<assign fromexpr='substring-before($macro_12_out_dec//*:quote/*:datetime," ")' toexpr='$macro_12_out_dec/*:quote/*:datetime' mode='replace' />
<assign fromvariable='macro_12_out_dec' outputvariable='DataDecorator_13_out' wires_id='DataDecorator_13' name='DataDecorator_13'/>
</sequence>
<variable name="Transformer_18_out" type="document" default="" />

<sequence  name="Transformer_18" wires_id="Transformer_18" outputvariable="Transformer_18_out" wires_type="Transformer" inputvariable="DataDecorator_13_out" ><constructor outputvariable="ctro1">
<Root>
<symbol>{$DataDecorator_13_out/*:quote/*:symbol/string()}</symbol>
<price>{$DataDecorator_13_out/*:quote/*:price/string()}</price>
<date>{$DataDecorator_13_out/*:quote/*:datetime/string()}</date>
<time>{$DataDecorator_13_out/*:quote/*:datetime/string()}</time>
<MapReduce>{$DataDecorator_13_out/*:quote/*:MapReduceKey/string()}</MapReduce>
</Root>
</constructor>
<assign fromvariable="ctro1" outputvariable = "Transformer_18_out"/></sequence>
<variable name="StringBuilder_21_out" type="string" default="" />
<assign wires_id="StringBuilder_21" wires_type="StringBuilder" fromexpr="concat($Transformer_18_out/*:Root/*:symbol,$Transformer_18_out/*:Root/*:date)" outputvariable="StringBuilder_21_out"/>

<variable name="Mapper_11_out" type="document" default="" />

<sequence  name="Mapper_11" wires_id="Mapper_11" outputvariable="Mapper_11_out" wires_type="Mapper" inputvariable="Transformer_18_out" ><constructor outputvariable="ctro1">
<stoc:quote xmlns:stoc="http://com.jackbe.com/emmlMapreduce/StockQuoteExample">
<stoc:symbol>{$Transformer_18_out/*:Root/*:symbol/string()}</stoc:symbol>
<stoc:price>{$Transformer_18_out/*:Root/*:price/string()}</stoc:price>
<stoc:date>{$Transformer_18_out/*:Root/*:date/string()}</stoc:date>
<stoc:time>{$Transformer_18_out/*:Root/*:time/string()}</stoc:time>
<stoc:MapReduceKey>{$StringBuilder_21_out}</stoc:MapReduceKey>
</stoc:quote>
</constructor>
<assign fromvariable="ctro1" outputvariable = "Mapper_11_out"/></sequence>
<xslt script="nsStrip.xsl" wires_id="NamespaceStripper_38" wires_type="NamespaceStripper" inputvariable="Mapper_11_out" outputvariable="output_0" />


</operation>
</mashup>