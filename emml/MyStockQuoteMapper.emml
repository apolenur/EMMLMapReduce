<mashup name="MyStockQuoteMapper" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openmashup.org/schemas/v1.0/EMML ../schemas/EMMLPrestoSpec.xsd" xmlns="http://www.openmashup.org/schemas/v1.0/EMML" xmlns:macro="http://www.openmashup.org/schemas/v1.0/EMMLMacro" xmlns:presto="http://www.jackbe.com/v1.0/EMMLPrestoExtensions" >
<operation name="runMashup" >

<namespaces></namespaces>
<variable name="limitRecords" type="number" default="-2"/>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"macro_8":{"label":"StockQuoteExample","__domain":"JEMSGlobalMacros"},"DataDecorator_4":{"label":"Data Decorator","decorations":{"/*:quote/*:datetime":{"fnsMap":[{"fnType":"string","fnName":"substringBefore","argValues":{"String Fragment of":{"value":"/*:quote/*:datetime","type":"PATH","emmlPath":"$macro_8_out_dec//*:quote/*:datetime"},"Before String":{"value":" ","type":"LITERAL","emmlPath":" "}},"selectedFn":9,"applyOrder":1,"occuranceNum":1}],"selectedFns":[9],"path":"/*:quote/*:datetime"}}},"Document_2":{"label":"Document","doc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"symbol","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$DataDecorator_4_out/*:quote/*:symbol"},"arrayParent":null},{"name":"price","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$DataDecorator_4_out/*:quote/*:price"},"arrayParent":null},{"name":"date","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$DataDecorator_4_out/*:quote/*:datetime"},"arrayParent":null},{"name":"MapReduceKey","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"{$StringBuilder_3_out}"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"TEMPLATE","TEMPLATE":null},"parent":null,"arrayParent":null}},"StringBuilder_3":{"label":"String Builder","ipStr":[["$DataDecorator_4_out/*:quote/*:symbol",0.13852401170879602],["$DataDecorator_4_out/*:quote/*:datetime",0.4332424341700971]]}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >14</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="580" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="Document_2" style="Document" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="460" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_5" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="Document_2" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_6" value="" style="port;image=images/wires/outport.png;" parent="Document_2" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="StringBuilder_3" style="StringBuilder" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="350" y="160" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_8" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="StringBuilder_3" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_9" value="" style="port;image=images/wires/outport.png;" parent="StringBuilder_3" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="11" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="DataDecorator_4" style="DataDecorator" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="210" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_12" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="DataDecorator_4" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_13" value="" style="port;image=images/wires/outport.png;" parent="DataDecorator_4" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="15" value="" parent="1" source="outport_13" target="inport_8" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="16" value="" parent="1" source="outport_13" target="inport_5" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="17" value="" parent="1" source="outport_9" target="inport_5" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="18" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="19" value="" parent="1" source="outport_6" target="inport_2" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="23" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="24" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="macro_8" style="macroTemplate" parent="1" vertex="true" connectable="0" label="" name="Macro" description="Macro"><mxGeometry x="70" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_25" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="macro_8" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_26" value="" style="port;image=images/wires/outport.png;" parent="macro_8" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="27" value="" parent="1" source="outport_26" target="inport_12" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"macro_8":{"label":"StockQuoteExample","__domain":"JEMSGlobalMacros"},"DataDecorator_4":{"label":"Data Decorator","decorations":{"/*:quote/*:datetime":{"fnsMap":[{"fnType":"string","fnName":"substringBefore","argValues":{"String Fragment of":{"value":"/*:quote/*:datetime","type":"PATH","emmlPath":"$macro_8_out_dec//*:quote/*:datetime"},"Before String":{"value":" ","type":"LITERAL","emmlPath":" "}},"selectedFn":9,"applyOrder":1,"occuranceNum":1}],"selectedFns":[9],"path":"/*:quote/*:datetime"}}},"Document_2":{"label":"Document","doc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"symbol","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$DataDecorator_4_out/*:quote/*:symbol"},"arrayParent":null},{"name":"price","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$DataDecorator_4_out/*:quote/*:price"},"arrayParent":null},{"name":"date","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$DataDecorator_4_out/*:quote/*:datetime"},"arrayParent":null},{"name":"MapReduceKey","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"{$StringBuilder_3_out}"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"TEMPLATE","TEMPLATE":null},"parent":null,"arrayParent":null}},"StringBuilder_3":{"label":"String Builder","ipStr":[["$DataDecorator_4_out/*:quote/*:symbol",0.13852401170879602],["$DataDecorator_4_out/*:quote/*:datetime",0.4332424341700971]]}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >20</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="580" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="Document_2" style="Document" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="460" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_5" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="Document_2" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_6" value="" style="port;image=images/wires/outport.png;" parent="Document_2" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="StringBuilder_3" style="StringBuilder" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="350" y="160" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_8" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="StringBuilder_3" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_9" value="" style="port;image=images/wires/outport.png;" parent="StringBuilder_3" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="11" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="DataDecorator_4" style="DataDecorator" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="210" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_12" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="DataDecorator_4" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_13" value="" style="port;image=images/wires/outport.png;" parent="DataDecorator_4" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="15" value="" parent="1" source="outport_13" target="inport_8" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="16" value="" parent="1" source="outport_13" target="inport_5" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="17" value="" parent="1" source="outport_9" target="inport_5" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="18" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="19" value="" parent="1" source="outport_6" target="inport_2" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="23" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="24" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="macro_8" style="macroTemplate" parent="1" vertex="true" connectable="0" label="" name="Macro" description="Macro"><mxGeometry x="70" y="100" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_25" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="macro_8" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_26" value="" style="port;image=images/wires/outport.png;" parent="macro_8" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="27" value="" parent="1" source="outport_26" target="inport_12" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>

<output output-encoding="UTF-8"  wires_id="output_0" name="output_0" type="document" service=""/>
<variable name="DataDecorator_4_out" type="document" default="" />
<variable name="macro_8_out" type="document" default="" />

<macro:StockQuoteExample  name="macro_8" outputvariable="macro_8_out" wires_id="macro_8" label="StockQuoteExample" emmlType="macro"  ></macro:StockQuoteExample>
<sequence wires_id='DataDecorator_4' wires_type='DataDecorator'>
<filter filterexpr='$macro_8_out' inputvariable='macro_8_out' outputvariable='macro_8_out_dec' />
<assign fromexpr='substring-before($macro_8_out_dec//*:quote/*:datetime," ")' toexpr='$macro_8_out_dec/*:quote/*:datetime' mode='replace' />
<assign fromvariable='macro_8_out_dec' outputvariable='DataDecorator_4_out' wires_id='DataDecorator_4' name='DataDecorator_4'/>
</sequence>

<variable name="StringBuilder_3_out" type="string" default="" />
<assign wires_id="StringBuilder_3" wires_type="StringBuilder" fromexpr="concat($DataDecorator_4_out/*:quote/*:symbol,$DataDecorator_4_out/*:quote/*:datetime)" outputvariable="StringBuilder_3_out"/>

<sequence  name="Document_2" wires_id="Document_2" outputvariable="output_0" wires_type="Document" ><constructor outputvariable="ctro1">
<Root>
<symbol>{$DataDecorator_4_out/*:quote/*:symbol/string()}</symbol>
<price>{$DataDecorator_4_out/*:quote/*:price/string()}</price>
<date>{$DataDecorator_4_out/*:quote/*:datetime/string()}</date>
<MapReduceKey>{$StringBuilder_3_out}</MapReduceKey>
</Root>
</constructor>
<assign fromvariable="ctro1" outputvariable = "output_0"/></sequence>


</operation>
</mashup>