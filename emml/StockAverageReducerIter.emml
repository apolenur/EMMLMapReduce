<mashup name="StockAverageReducerIter" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openmashup.org/schemas/v1.0/EMML ../schemas/EMMLPrestoSpec.xsd" xmlns="http://www.openmashup.org/schemas/v1.0/EMML" xmlns:macro="http://www.openmashup.org/schemas/v1.0/EMMLMacro" xmlns:presto="http://www.jackbe.com/v1.0/EMMLPrestoExtensions" >
<operation name="runMashup" >

<namespaces></namespaces>
<variable name="limitRecords" type="number" default="-2"/>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"macro_MapReduceAverage_21":{"label":"MapReduceAverage","__domain":"JEMSGlobalMacros"}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >30</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="380" y="150" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="macro_MapReduceAverage_21" style="macro:MapReduceAverage" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="170" y="150" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_71" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="macro_MapReduceAverage_21" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_72" value="" style="port;image=images/wires/outport.png;" parent="macro_MapReduceAverage_21" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="90" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="93" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="95" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="111" value="" edge="1" parent="1" source="outport_72" target="inport_2"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"macro_MapReduceAverage_21":{"label":"MapReduceAverage","__domain":"JEMSGlobalMacros"},"Document_34":{"label":"Document","doc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"Results","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":[{"name":"Average","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode/*:NewNode","pathWithActualNS":"/Root/NewNode/NewNode","pathWithoutNS":"/Root/NewNode/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$macro_MapReduceAverage_21_out/*:Root/*:average"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"TEMPLATE","TEMPLATE":null},"parent":null,"arrayParent":null}},"macro_GetXPath_35":{"label":"GetXPath","__domain":"JEMSGlobalMacros"}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >36</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="300" y="180" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="macro_MapReduceAverage_21" style="macro:MapReduceAverage" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="-80" y="180" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_71" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="macro_MapReduceAverage_21" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_72" value="" style="port;image=images/wires/outport.png;" parent="macro_MapReduceAverage_21" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="90" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="93" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="95" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="Document_34" style="Document" vertex="true" connectable="0" label="" name="Operation" description="Service Operation" parent="1"><mxGeometry x="130" y="180" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_121" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" vertex="1" parent="Document_34" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_122" value="" style="port;image=images/wires/outport.png;" vertex="1" parent="Document_34" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="124" value="" edge="1" parent="1" source="outport_122" target="inport_2"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="127" value="" edge="1" parent="1" source="outport_72" target="inport_121"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="macro_GetXPath_35" style="macro:GetXPath" vertex="true" connectable="0" label="" name="Operation" description="Service Operation" parent="1"><mxGeometry x="230" y="80" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_128" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" vertex="1" parent="macro_GetXPath_35" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_129" value="" style="port;image=images/wires/outport.png;" vertex="1" parent="macro_GetXPath_35" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="131" edge="1" parent="1" source="outport_72" target="inport_128"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="132" edge="1" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_createdBy"  >Wires</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_state"  ><![CDATA[{}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_customProperties"  ><![CDATA[{"macro_MapReduceAverage_21":{"label":"MapReduceAverage","__domain":"JEMSGlobalMacros"},"Document_34":{"label":"Document","doc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"Results","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":[{"name":"Average","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode/*:NewNode","pathWithActualNS":"/Root/NewNode/NewNode","pathWithoutNS":"/Root/NewNode/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"COPY","TEMPLATE":null,"COPY":"$macro_MapReduceAverage_21_out/*:Root/*:average"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"TEMPLATE","TEMPLATE":null},"parent":null,"arrayParent":null}},"Document_38":{"label":"Document","doc":{"name":"Root","aName":"Root","records":[],"namespaces":{},"root":null,"tagName":"Root","path":"/*:Root","pathWithActualNS":"/Root","pathWithoutNS":"/Root","type":"complex","childElements":[{"name":"Node1","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode","pathWithActualNS":"/Root/NewNode","pathWithoutNS":"/Root/NewNode","type":"string","childElements":[{"name":"SubNode1","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode/*:NewNode","pathWithActualNS":"/Root/NewNode/NewNode","pathWithoutNS":"/Root/NewNode/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"TEMPLATE","TEMPLATE":"1"},"arrayParent":null},{"name":"SubNode2","aName":"NewNode","root":null,"parent":null,"tagName":"NewNode","path":"/*:Root/*:NewNode/*:NewNode","pathWithActualNS":"/Root/NewNode/NewNode","pathWithoutNS":"/Root/NewNode/NewNode","type":"string","childElements":null,"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"map":{"type":"TEMPLATE","TEMPLATE":"2"},"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"arrayParent":null}],"minOccurs":null,"maxOccurs":null,"values":null,"flag":0,"isComplex":true,"map":{"type":"TEMPLATE","TEMPLATE":null},"parent":null,"arrayParent":null}},"macro_GetXPath_39":{"label":"GetXPath","__domain":"JEMSGlobalMacros"}}]]></presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_sequenceNumber"  >40</presto:presto-meta>
<presto:presto-meta wires_id="" name="prestoMeta_WiresGraphXML"  ><![CDATA[<mxGraphModel><root><MashupService label="Mashup Service" name="untitled" description="" id="0"><mxCell/></MashupService><Layer label="Default Layer" id="1"><mxCell parent="0"/></Layer><mxCell id="output_0" style="output" parent="1" vertex="true" connectable="0" label="" name="MashupOutput" description="Output of the Mashup"><mxGeometry x="330" y="80" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_2" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="output_0" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="macro_MapReduceAverage_21" style="macro:MapReduceAverage" parent="1" vertex="true" connectable="0" label="" name="Operation" description="Service Operation"><mxGeometry x="-80" y="180" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_71" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" parent="macro_MapReduceAverage_21" vertex="1" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_72" value="" style="port;image=images/wires/outport.png;" parent="macro_MapReduceAverage_21" vertex="1" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="90" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="93" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="95" parent="1" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="Document_34" style="Document" vertex="true" connectable="0" label="" name="Operation" description="Service Operation" parent="1"><mxGeometry x="130" y="180" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_121" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" vertex="1" parent="Document_34" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_122" value="" style="port;image=images/wires/outport.png;" vertex="1" parent="Document_34" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="127" value="" edge="1" parent="1" source="outport_72" target="inport_121"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="Document_38" style="Document" vertex="true" connectable="0" label="" name="Operation" description="Service Operation" parent="1"><mxGeometry x="-70" y="80" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_135" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" vertex="1" parent="Document_38" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_136" value="" style="port;image=images/wires/outport.png;" vertex="1" parent="Document_38" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="macro_GetXPath_39" style="macro:GetXPath" vertex="true" connectable="0" label="" name="Operation" description="Service Operation" parent="1"><mxGeometry x="100" y="70" width="40" height="40" as="geometry"><mxRectangle width="48" height="48" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="inport_141" value="" style="port;image=images/wires/inport.png;align=right;imageAlign=right;spacingRight=18px;" vertex="1" parent="macro_GetXPath_39" isPort="1" isInport="1"><mxGeometry x="0.01" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-6" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="outport_142" value="" style="port;image=images/wires/outport.png;" vertex="1" parent="macro_GetXPath_39" isPort="1" isInport="0"><mxGeometry x="0.92" y="0.4" width="16" height="16" relative="1" as="geometry"><mxPoint x="-8" y="-8" as="offset"/></mxGeometry></mxCell><mxCell id="143" value="" edge="1" parent="1" source="outport_136" target="inport_141"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="144" edge="1" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>]]></presto:presto-meta>

<output output-encoding="UTF-8"  wires_id="output_0" name="output_0" type="string" service=""/>
<variable name="Document_38_out" type="document" default="" />

<sequence  name="Document_38" wires_id="Document_38" outputvariable="Document_38_out" wires_type="Document" ><constructor outputvariable="ctro1">
<Root>
</Root>
</constructor>
<constructor outputvariable="ctro2">
<Node1>
<SubNode1>1</SubNode1>
<SubNode2>2</SubNode2>
</Node1>
</constructor>
<appendresult outputvariable = "ctro1">
$ctro2
</appendresult>
<assign fromvariable="ctro1" outputvariable = "Document_38_out"/></sequence>
<macro:GetXPath  name="macro_GetXPath_37" outputvariable="output_0" wires_id="macro_GetXPath_37" label="GetXPath" doc="$Document_38_out" xpathstr="$Document_38_out"  ></macro:GetXPath>
<variable name="macro_MapReduceAverage_21_out" type="document" default="" />

<macro:MapReduceAverage  name="macro_MapReduceAverage_21" outputvariable="macro_MapReduceAverage_21_out" wires_id="macro_MapReduceAverage_21" label="MapReduceAverage" nodeName="price" emmlType="macro:MapReduceAverage"  ></macro:MapReduceAverage>
<variable name="Document_34_out" type="document" default="" />

<sequence  name="Document_34" wires_id="Document_34" outputvariable="Document_34_out" wires_type="Document" inputvariable="macro_MapReduceAverage_21_out" ><constructor outputvariable="ctro1">
<Root>
</Root>
</constructor>
<constructor outputvariable="ctro2">
<Results>
<Average>{$macro_MapReduceAverage_21_out/*:Root/*:average/string()}</Average>
</Results>
</constructor>
<appendresult outputvariable = "ctro1">
$ctro2
</appendresult>
<assign fromvariable="ctro1" outputvariable = "Document_34_out"/></sequence>
<variable name="macro_GetXPath_39_out" type="string" default="" />

<macro:GetXPath  name="macro_GetXPath_39" outputvariable="macro_GetXPath_39_out" wires_id="macro_GetXPath_39" label="GetXPath" doc="$Document_38_out" xpathstr="$Document_38_out"  ></macro:GetXPath>


</operation>
</mashup>